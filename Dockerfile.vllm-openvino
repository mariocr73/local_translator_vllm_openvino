FROM docker.io/openvino/ubuntu22_runtime:latest

USER root

RUN apt-get update && apt-get install -y --no-install-recommends \
    python3 python3-pip python3-venv \
    git build-essential cmake curl ca-certificates \
    ocl-icd-libopencl1 clinfo \
 && rm -rf /var/lib/apt/lists/*

RUN python3 -m pip install --no-cache-dir --upgrade pip \
 && python3 -m pip install --no-cache-dir \
    "openvino>=2025.0" "optimum[openvino,nncf]" "uvicorn>=0.30"

# Instalar vLLM-OpenVINO desde git (sin requirements.txt)
RUN python3 -m pip install --no-cache-dir \
    "git+https://github.com/vllm-project/vllm-openvino.git"

ENV VLLM_DEVICE=xpu \
    HF_HUB_OFFLINE=1

# ðŸ‘‡ Fuerza directorio de trabajo fuera de /opt/intel/openvino
RUN mkdir -p /app
WORKDIR /app

VOLUME ["/models", "/root/.cache/huggingface"]
EXPOSE 8000




